digraph compliance_basics {
    graph[labeljust="l"];

    subgraph cluster_regulations {
        label="Regulations";
        node[width=1, shape=box, style=rounded];

        HIPAA
        PDL
        GDPR
        CCPA
    }

    subgraph cluster_isms {
        label="Information Security Standards"
        node[width=1, shape=box, style=rounded];

        "ISO 27001"
        "SOC-2"
        "PCI-DSS"
    }

    subgraph cluster_policies {
        label="Policies"
        node[width=1, shape=circle];

        { HIPAA, PDL, GDPR, CCPA } -> Controls
        { "ISO 27001", "PCI-DSS", "SOC-2" } -> Controls

        node[width=1, shape=box, style=rounded];
        Controls -> {
            supplier[label="Supplier\nmanagement"]
            access[label="Access\ncontrol"]
            "Logging"
            "Backups"
            incident[label="Incident\nmanagement"]
            vulnerability[label="Vulnerability\nmanagement"]
            intrusion[label="Intrusion\ndetection"]
            network[label="Communication\nsecurity"]
            crypto[label="Use of\ncryptography"]
        }
    }

    subgraph cluster_implementation {
        label="Compliant Kubernetes"

        node[shape=none, label=""];

        //supplier -> { kubernetes[image="logos/kubernetes.png",height=0.5] }
        access -> { dex[image="logos/dex.png"] }
        "Backups" -> { velero[image="logos/velero.png"] }
        "Logging" -> { elasticsearch[image="logos/elasticsearch.png"] }
        incident -> { prometheus[image="logos/prometheus.png"] }
        vulnerability
            -> { harbor[image="logos/harbor.png"] }
            -> { trivy[image="logos/trivy.png"] }
        intrusion -> { falco[image="logos/falco.png"] }
        network -> { calico[image="logos/project-calico.png"] }
        crypto
            -> { certmanager[image="logos/cert-manager.png"] }
            -> { letsencrypt[image="logos/letsencrypt.png"] }
    }

    subgraph cluster_provider {
        label="Compliant Cloud Provider"

        node[shape=none, label="", imagescale=height, width=1.5, height=1, fixedsize=true];

        supplier -> {
            aws[image="aws.svg"]
            citycloud[image="citycloud.png"]
            exoscale[image="exoscale.svg"]
            safespring[image="safespring.png"]
            vmware[image="v-mware-v-sphere.svg"]
            byom[label="Bring\nYour Own\nMetal",shape=box]
        }
    }
}
